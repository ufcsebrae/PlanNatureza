<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard de Execução Orçamentária</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <style>
        .card { background-color: white; border-radius: 0.75rem; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1), 0 2px 4px -2px rgba(0,0,0,0.1); padding: 1.5rem; }
        .kpi-title { font-size: 0.875rem; color: #475569; font-weight: 500; }
        .kpi-value { font-size: 2.25rem; font-weight: 700; color: #1e293b; }
        .kpi-perc { font-size: 1.25rem; }
        .kpi-sub { font-size: 0.875rem; color: #64748b; }
        .chart-container { position: relative; height: 400px; width: 100%; }
        body { background-color: #f8fafc; }
    </style>
</head>
<body class="p-4 md:p-8">
    <main class="max-w-7xl mx-auto">
        <!-- Header -->
        <div class="card mb-8">
            <h1 class="text-3xl font-bold text-gray-800">Dashboard de Execução Orçamentária 2025</h1>
            <p id="unit-name" class="text-xl text-indigo-600 font-semibold mt-1">__UNIDADE_ALVO__</p>
        </div>

        <!-- KPIs -->
        <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
            <div class="card text-center"><h2 class="kpi-title">Execução Total (Geral)</h2><p class="kpi-value"><span class="kpi-perc">__KPI_TOTAL_PERC__</span></p><p class="kpi-sub">__KPI_TOTAL_VALORES__</p></div>
            <div class="card text-center"><h2 class="kpi-title">Projetos Exclusivos da Unidade</h2><p class="kpi-value"><span class="kpi-perc">__KPI_EXCLUSIVO_PERC__</span></p><p class="kpi-sub">__KPI_EXCLUSIVO_VALORES__</p></div>
            <div class="card text-center"><h2 class="kpi-title">Projetos Compartilhados</h2><p class="kpi-value"><span class="kpi-perc">__KPI_COMPARTILHADO_PERC__</span></p><p class="kpi-sub">__KPI_COMPARTILHADO_VALORES__</p></div>
        </div>
        
        <!-- Outros Gráficos Chart.js -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mt-8">
            <div class="card"><h2 class="text-xl font-bold text-gray-800 mb-4">Tendência de Execução Mensal</h2><div class="chart-container"><canvas id="trendChart"></canvas></div></div>
            <div class="card"><h2 class="text-xl font-bold text-gray-800 mb-4">Orçamento Ocioso por Projeto (Top 7)</h2><div class="chart-container"><canvas id="idleBudgetChart"></canvas></div></div>
        </div>
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mt-8">
            <div class="card"><h2 class="text-xl font-bold text-gray-800 mb-4">Execução por Natureza (Projetos Exclusivos)</h2><div class="chart-container"><canvas id="treemapExclusivo"></canvas></div></div>
            <div class="card"><h2 class="text-xl font-bold text-gray-800 mb-4">Execução por Natureza (Projetos Compartilhados)</h2><div class="chart-container"><canvas id="treemapCompartilhado"></canvas></div></div>
        </div>
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mt-8">
            <div class="card"><h2 class="text-xl font-bold text-gray-800 mb-4">Execução Sem Orçamento (Projetos Exclusivos)</h2><div class="chart-container"><canvas id="unplannedExclusivo"></canvas></div></div>
            <div class="card"><h2 class="text-xl font-bold text-gray-800 mb-4">Execução Sem Orçamento (Projetos Compartilhados)</h2><div class="chart-container"><canvas id="unplannedCompartilhado"></canvas></div></div>
        </div>

        <!-- Seção de Análise de Projetos Exclusivos -->
        <div class="grid grid-cols-1 gap-8 my-10">
            <div class="card">
                <h2 class="text-2xl font-bold text-gray-800 mb-2">Análise Detalhada de Projetos Exclusivos</h2>
                <p class="text-sm text-gray-500 mb-6">As visualizações abaixo focam apenas nos projetos cuja gestão orçamentária é exclusiva da unidade, permitindo uma análise profunda de proporção e performance.</p>
            </div>
        </div>

        <!-- Sunburst Chart -->
        <div class="grid grid-cols-1 gap-8 mb-10">
            <div class="card">
                <h2 class="text-xl font-bold text-gray-800 mb-2">Visão Hierárquica do Orçamento (Sunburst)</h2>
                <p class="text-sm text-gray-500 mb-4">Distribuição do <strong>Valor Planejado</strong> (tamanho da fatia) por Projeto e Natureza. A cor indica o <strong>Percentual de Execução</strong> (quanto mais verde, melhor a execução).</p>
                <div id="sunburstProjetos" class="chart-container" style="height: 500px;">__SUNBURST_PLACEHOLDER__</div>
            </div>
        </div>

        <!-- Heatmap Chart (Versão Original) -->
        <div class="grid grid-cols-1 gap-8 mb-10">
            <div class="card">
                <h2 class="text-xl font-bold text-gray-800 mb-2">Mapa de Performance (Heatmap)</h2>
                <p class="text-sm text-gray-500 mb-4">Cruzamento da performance de execução (%) entre Projetos e Naturezas Orçamentárias.</p>
                <div id="heatmapProjetos" class="chart-container" style="height: 600px;">__HEATMAP_PLACEHOLDER__</div>
            </div>
        </div>
    </main>

    <!-- Ilha de dados JSON para os gráficos Chart.js -->
    <script id="data-island" type="application/json">__JSON_DATA_PLACEHOLDER__</script>

    <!-- Script para renderizar os gráficos -->
    <script>
        // Seu script JS original para renderizar os gráficos do Chart.js.
        // Ele lerá os dados da "data-island" e populará os <canvas>.
    </script>
</body>
</html>
